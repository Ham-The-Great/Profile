<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Card Spending Tracker</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
        body {
            font-size: 16px;
            line-height: 1.5;
        }

        .container {
            padding: 1rem;
        }

        h1, h3 {
            font-size: 1.5rem;
        }

        .form-control, .btn {
            font-size: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 0.5rem;
            text-align: left;
        }

        th {
            background-color: #f8f9fa;
        }

        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h1 class="text-center mb-4">Credit Card Spending Tracker</h1>
    <div class="mb-4">
        <h3>Record Spending</h3>
        <form id="spending-form">
            <div class="form-group">
                <label for="amount">Amount</label>
                <input type="number" class="form-control" id="amount" required>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <input type="text" class="form-control" id="description" required>
            </div>
            <button type="submit" class="btn btn-primary btn-block">Add Spending</button>
        </form>
    </div>
    <div class="mb-4">
        <h3>Upload Credit Card Statement</h3>
        <input type="file" class="form-control-file" id="statement-file">
        <button class="btn btn-primary btn-block mt-2" id="upload-statement">Upload and Compare</button>
    </div>
    <div class="mt-4">
        <h3>Comparison Results</h3>
        <table class="table table-bordered" id="results-table">
            <thead>
            <tr>
                <th>Description</th>
                <th>Amount</th>
                <th>Status</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('spending-form');
        const statementFile = document.getElementById('statement-file');
        const resultsTable = document.getElementById('results-table').getElementsByTagName('tbody')[0];
        
        form.addEventListener('submit', function (event) {
            event.preventDefault();
            const amount = document.getElementById('amount').value;
            const description = document.getElementById('description').value;
            const spending = {amount: parseFloat(amount), description: description};
            
            let spendings = JSON.parse(localStorage.getItem('spendings')) || [];
            spendings.push(spending);
            localStorage.setItem('spendings', JSON.stringify(spendings));
            
            form.reset();
        });
        
        document.getElementById('upload-statement').addEventListener('click', function () {
            if (statementFile.files.length === 0) return alert('Please upload a PDF file.');
            
            const fileReader = new FileReader();
            fileReader.onload = function () {
                const pdfData = fileReader.result;
                compareTransactions(pdfData);
            };
            fileReader.readAsArrayBuffer(statementFile.files[0]);
        });
        
        async function compareTransactions(pdfData) {
            const pdfDoc = await PDFLib.PDFDocument.load(pdfData);
            const text = await pdfDoc.getTextContent();
            const transactions = parsePdfTransactions(text);
            
            const spendings = JSON.parse(localStorage.getItem('spendings')) || [];
            resultsTable.innerHTML = '';
            
            transactions.forEach(transaction => {
                const row = resultsTable.insertRow();
                const cellDescription = row.insertCell(0);
                const cellAmount = row.insertCell(1);
                const cellStatus = row.insertCell(2);
                
                cellDescription.textContent = transaction.description;
                cellAmount.textContent = transaction.amount.toFixed(2);
                
                const match = spendings.find(sp => sp.amount === transaction.amount && sp.description === transaction.description);
                if (match) {
                    cellStatus.textContent = 'Match';
                } else {
                    cellStatus.textContent = 'Not Found';
                    row.style.backgroundColor = 'yellow';
                }
            });
        }

        function parsePdfTransactions(text) {
            // This is a dummy implementation. Replace it with actual parsing logic.
            return [
                {amount: 10.00, description: 'Coffee'},
                {amount: 50.00, description: 'Groceries'}
            ];
        }
    });
</script>
</body>
</html>
